# 重建路由

* 路由不存在，或GID、XID路由节点全部被删除（访问门限收缩至配置文件中最低门限限制10），被当作全部过载处理。当发生这种情况，将直接进入宕机恢复逻辑，并不用等到一个周期结束。

* 每个周期结束，并距上次重建时间间隔不超过2个周期时，进入重建、宕机路由逻辑，否则只更新重建时间戳标识为当前时间（防止时间跳变）。

* 当前周期无请求：成功率设置为1。时延不变（使用最近一个周期时延值）

* 失败率=(失败数+超时数)/总请求数。成功率=1-失败率。节点平均错误率=在非压力故障的情况下，统计多个周期的错误率并加以平均得到，即：所有节点总错误率/节点数量，当节点错误率小于配置限制，重置为0。

* 时延=总用时/成功次数。当某一周期无成功请求数（且失败数大于0）。总请求数超过阈值最低限制，时延设置为最大值，否则时延增加一倍，直至100s

* 门限调整，如上。

* 负载计算，如上。

* 过载判断，如上。
